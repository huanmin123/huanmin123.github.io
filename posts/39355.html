<!DOCTYPE HTML><html lang="zh-CN"><head><meta charset="utf-8"><meta name="keywords" content="什么是进程和线程,多线程介绍,多线程的好处,多线程的创建,多线程中的方法,sleep()_join()_yield(),线程锁synchronized,炫舞案例"><meta name="description" content=""><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><meta name="renderer" content="webkit|ie-stand|ie-comp"><meta name="mobile-web-app-capable" content="yes"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><title>java多线程基础 | 码虫</title><link rel="icon" type="image/x-icon, image/vnd.microsoft.icon" href="http://img.huitoushian.cn/%E5%8D%9A%E5%AE%A2/Login/favicon.ico"><link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css"><link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css"><link rel="stylesheet" type="text/css" href="/libs/aos/aos.css"><link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css"><link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css"><link rel="stylesheet" type="text/css" href="/css/matery.css"><link rel="stylesheet" type="text/css" href="/css/my.css"><script src="/libs/jquery/jquery.min.js"></script><meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="码虫" type="application/atom+xml"><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"><link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head><body><header class="navbar-fixed"><nav id="headNav" class="bg-color nav-transparent"><div id="navContainer" class="nav-wrapper container"><div class="brand-logo"><a href="/" class="waves-effect waves-light"><div><img src="http://img.huitoushian.cn/%E5%8D%9A%E5%AE%A2/%E8%BD%AE%E6%92%AD%E5%9B%BE%E5%92%8C%E6%96%87%E7%AB%A0%E9%9A%8F%E6%9C%BA%E5%9B%BE/loading.gif" data-original="http://img.huitoushian.cn/%E5%8D%9A%E5%AE%A2/Login/Login.png" class="logo-img" alt="LOGO"> <span class="logo-span">码虫</span></div></a></div><a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a><ul class="right nav-menu"><li class="hide-on-med-and-down nav-item"><a href="/" class="waves-effect waves-light"><i class="fas fa-home" style="zoom:.6"></i> <span>主页</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/tags" class="waves-effect waves-light"><i class="fas fa-tags" style="zoom:.6"></i> <span>标签</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/categories" class="waves-effect waves-light"><i class="fas fa-bookmark" style="zoom:.6"></i> <span>分类目录</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/archives" class="waves-effect waves-light"><i class="fas fa-archive" style="zoom:.6"></i> <span>档案</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/about" class="waves-effect waves-light"><i class="fas fa-user-circle" style="zoom:.6"></i> <span>关于我</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/contact" class="waves-effect waves-light"><i class="fas fa-comments" style="zoom:.6"></i> <span>联系</span></a></li><li><a href="#searchModal" class="modal-trigger waves-effect waves-light"><i id="searchIcon" class="fas fa-search" title="搜索" style="zoom:.85"></i></a></li></ul><div id="mobile-nav" class="side-nav sidenav"><div class="mobile-head bg-color"><img src="http://img.huitoushian.cn/%E5%8D%9A%E5%AE%A2/%E8%BD%AE%E6%92%AD%E5%9B%BE%E5%92%8C%E6%96%87%E7%AB%A0%E9%9A%8F%E6%9C%BA%E5%9B%BE/loading.gif" data-original="http://img.huitoushian.cn/%E5%8D%9A%E5%AE%A2/Login/Login.png" class="logo-img circle responsive-img"><div class="logo-name">码虫</div><div class="logo-desc">Never really desperate, only the lost of the soul.</div></div><ul class="menu-list mobile-menu-list"><li class="m-nav-item"><a href="/" class="waves-effect waves-light"><i class="fa-fw fas fa-home"></i> 主页</a></li><li class="m-nav-item"><a href="/tags" class="waves-effect waves-light"><i class="fa-fw fas fa-tags"></i> 标签</a></li><li class="m-nav-item"><a href="/categories" class="waves-effect waves-light"><i class="fa-fw fas fa-bookmark"></i> 分类目录</a></li><li class="m-nav-item"><a href="/archives" class="waves-effect waves-light"><i class="fa-fw fas fa-archive"></i> 档案</a></li><li class="m-nav-item"><a href="/about" class="waves-effect waves-light"><i class="fa-fw fas fa-user-circle"></i> 关于我</a></li><li class="m-nav-item"><a href="/contact" class="waves-effect waves-light"><i class="fa-fw fas fa-comments"></i> 联系</a></li><li><div class="divider"></div></li><li><a href="https://github.com/" class="waves-effect waves-light" target="_blank"><i class="fab fa-github-square fa-fw"></i>Fork Me</a></li></ul></div></div><style>.nav-transparent .github-corner{display:none!important}.github-corner{position:absolute;z-index:10;top:0;right:0;border:0;transform:scale(1.1)}.github-corner svg{color:#0f9d58;fill:#fff;height:64px;width:64px}.github-corner:hover .octo-arm{animation:a .56s ease-in-out}.github-corner .octo-arm{animation:none}@keyframes a{0%,to{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}</style><a href="https://github.com/" class="github-corner tooltipped hide-on-med-and-down" target="_blank" data-tooltip="Fork Me" data-position="left" data-delay="50"><svg viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a></nav></header><div class="bg-cover pd-header post-cover" style="background-image:url(http://img.huitoushian.cn/%E5%8D%9A%E5%AE%A2/%E8%BD%AE%E6%92%AD%E5%9B%BE%E5%92%8C%E6%96%87%E7%AB%A0%E9%9A%8F%E6%9C%BA%E5%9B%BE/featureimages/138.jpg)"><div class="container" style="right:0;left:0"><div class="row"><div class="col s12 m12 l12"><div class="brand"><h1 class="description center-align post-title">java多线程基础</h1></div></div></div></div></div><main class="post-container content"><link rel="stylesheet" href="/libs/tocbot/tocbot.css"><style>#articleContent h1::before,#articleContent h2::before,#articleContent h3::before,#articleContent h4::before,#articleContent h5::before,#articleContent h6::before{display:block;content:" ";height:100px;margin-top:-100px;visibility:hidden}#articleContent :focus{outline:0}.toc-fixed{position:fixed;top:64px}.toc-widget{width:345px;padding-left:20px}.toc-widget .toc-title{margin:35px 0 15px 0;padding-left:17px;font-size:1.5rem;font-weight:700;line-height:1.5rem}.toc-widget ol{padding:0;list-style:none}#toc-content{height:calc(100vh - 250px);overflow:auto}#toc-content ol{padding-left:10px}#toc-content ol li{padding-left:10px}#toc-content .toc-link:hover{color:#42b983;font-weight:700;text-decoration:underline}#toc-content .toc-link::before{background-color:transparent;max-height:25px;position:absolute;right:23.5vw;display:block}#toc-content .is-active-link{color:#42b983}#floating-toc-btn{position:fixed;right:15px;bottom:76px;padding-top:15px;margin-bottom:0;z-index:998}#floating-toc-btn .btn-floating{width:48px;height:48px}#floating-toc-btn .btn-floating i{line-height:48px;font-size:1.4rem}</style><div class="row"><div id="main-content" class="col s12 m12 l9"><div id="artDetail"><div class="card"><div class="card-content article-info"><div class="row tag-cate"><div class="col s7"><div class="article-tag"><a href="/tags/java/"><span class="chip bg-color">java</span></a></div></div><div class="col s5 right-align"><div class="post-cate"><i class="fas fa-bookmark fa-fw icon-category"></i> <a href="/categories/java/" class="post-category">java</a></div></div></div><div class="post-info"><div class="post-date info-break-policy"><i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp; 2020-06-16</div><div class="info-break-policy"><i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp; 12.7k</div><div id="busuanzi_container_page_pv" class="info-break-policy"><i class="far fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp; <span id="busuanzi_value_page_pv"></span></div></div></div><hr class="clearfix"><div class="card-content article-card-content"><div id="articleContent"><h1 align="center">java多线程基础</h1><h2 id="什么是进程和线程"><a href="#什么是进程和线程" class="headerlink" title="什么是进程和线程"></a>什么是进程和线程</h2><p><strong>进程</strong>：启动一个QQ.exe就叫一个进程。 接着又启动一个360.exe，这叫两个进程。以此类推，每个独立执行的程序都称为进程。可以从Windows任务管理器中查看 进程栏里</p><p>Java 给多线程编程提供了内置的支持。一条线程指的是进程中的一条执行路径，一个进程可以并发多个线程，每个线程并行 执行不同的任务。一个进程一直运行，直到所有的非守护线程都结束运行后才能结束。</p><p><strong>进程的特点是</strong></p><ol><li><p>进程是系统运行的基本单位</p></li><li><p>每一个进程都有自己的一块内存空间 ,一组系统资源</p></li><li><p>每一个进程的内部数据和状态都是完全独立的</p></li></ol><p><strong>线程</strong>：线程是在进程内部同时做的事情，比如在QQ里，有很多事情要同时做，比如发送消息和接受消息，同时上传文件，这就是由多线程</p><p>线程是进程中执行运算的最小单位 ,可完成一个独立的顺序控制流程 ,每一个进程中至少有一个线程 这个线程 称为主线程 来作为这个程序的主入口点 比如java中的main方法 就是主线程,如果一个程序中同时运行了多个线程 , 用来完成不同的工作则称为多线程</p><p><strong>线程的特点是</strong></p><p>一个进程在其执行的过程中可以产生多个线程。与进程不同的是同类的多个线程共享进程的<strong>堆</strong>和<strong>方法区</strong>资源，但每个线程有自己的<strong>程序计数器</strong>、<strong>虚拟机栈</strong>和<strong>本地方法栈</strong>，所以系统在产生一个线程，或是在各个线程之间作切换工作时，负担要比进程小得多，也正因为如此，线程也被称为轻量级进程。</p><p><strong>单核cpu:</strong><br>实现多进程依靠于操作系统的进程调度算法,比如时间片轮转算法,比如有3个正在运行的程序(即三个进程),操作系统会让单核cpu轮流来运行这些进程,然后一个进程只运行2ms,这样看起来就像多个进程同时在运行,从而实现多进程.</p><p>多线程其实是最大限度的利用cpu资源.一个拥有两个线程的进程的执行时间可能比一个线程的进程执行两遍的时间还长一点,因为线程的切换也需要时间.即采用多线程可能不会提高程序的运行速度,反而会降低速度,但是对于用户来说,可以减少用户的响应时间.</p><p><strong>多核cpu:</strong><br>什么是多核cpu?多核cpu是一枚处理器中集成多个完整的计算引擎(内核).</p><p>多核cpu和单核cpu对于进程来说都是并发,并不是并行.</p><p>但是多核cpu每一个核心都可以独立执行一个线程,所以多核cpu可以真正实现多线程的并行.比如四核可以把线程1234分配给核心1234,如果还有线程567就要等待cpu的调度.线程1234属于并行;如果一会核心1停止执行线程1改为执行线程5,那线程15属于并发.</p><p><strong>什么是并行</strong></p><p>AB(线程)两人要挖坑，你有两把铁锹，一人一把开始挖 同时进行</p><p><strong>什么是并发</strong></p><p>AB两人(线程)要挖坑，但是只有一把铁锹，所以铁锹给A用五分钟，然后再给B用5分钟，然后再给A，。。。。如此往复</p><p><strong>对CPU来说</strong>：</p><p>系统可以分配给每个进程一段有限的执行 CPU 的时间（也称为 CPU 时间片），CPU 在这段时间中执行某个进程，然后下一个时间段又跳到另一个进程中去执行。由于 CPU 切换的速度非常快，给使用者的感受就是这些任务似乎在同时运行，所以使用多线程技术后，可以在同一时间内运行更多不同种类的任务。<br>单线程与多线程：</p><p>单线程的特点就是排队执行，也就是同步，就像在 cmd 中输入一条命令后，必须等待这条命令执行完才可以执行下一条命令一样。这就是单线程环境的缺点，即 CPU 利用率大幅降低。</p><p>多线程环境下的执行模式，CPU 完全可以在任务 1 和任务 2 之间来回切换，使任务 2 不必等到 任务1执行完后 再运行，系统的运行效率大大得到提升。</p><p><strong>线程必然不是越多越好，线程切换也是要开销的，当你增加一个线程的时候，增加的额外开销要小于该线程能够消除的阻塞时间，这才叫物有所值。</strong></p><p><strong>进程与线程的选择取决以下几点</strong>：</p><p>1、需要频繁创建销毁的优先使用线程；因为对进程来说创建和销毁一个进程代价是很大的。</p><p>2、线程的切换速度快，所以在需要大量计算，切换频繁时用线程，还有耗时的操作使用线程可提高应用程序的响应</p><p>3、因为对CPU系统的效率使用上,线程更占优，所以可能要发展到多机分布的用进程，多核分布用线程；</p><p>4、并行操作时使用线程，如C/S架构的服务器端并发线程响应用户的请求；</p><p>5、需要更稳定安全时，适合选择进程；需要速度时，选择线程更好。</p><h2 id="多线程介绍"><a href="#多线程介绍" class="headerlink" title="多线程介绍"></a>多线程介绍</h2><p>由于单cpu的计算机中cpu同时只能执行一条指令,因此在仅有一个cpu的计算机上不可能同时执行多个任务的,而是将cpu的执行时间分成多个 时间片段 交个不同的线程执行</p><p>表名看上去是多个线程同时执行,实际上是因为不同线程之间切换的实际非常短,</p><p>也许就几毫秒 ,所以看不出来的 这样就看似多线程了</p><p>就比张某 在某公司工作 他有时候工作很单一(就写代码) 这就好比只执行一个线程</p><p>但是在单一的环境中,每个程序执行的方式只有一种处理 的顺序 (这对于一般情况比较理想)</p><p>可是,有时比较忙的时候 还要兼顾其他工作 比如 修改 bug 比如 编写文档 等</p><p>项目经理 一般会希望张平一天内多个项工作都有进展 但是张平 在同一时间只能干一件事</p><p>一天工作9小时 其实打代码 时间就3个小时但是剩余的实际都被浪费了 他把9小时他分成了 不同份 来分给 不同的任务 到 时间就结束当前任务无论是否完成 都会 执行下一个时间点的线程任务 9小时过去了 所有任务都 有进展 也没有浪费任何时间 和资源 (看起来就像是压榨员工 不让他有一点的休息时间)</p><p>这就是多线程的原理</p><p><strong>一个线程的生命周期</strong></p><p>线程是一个动态执行的过程，它也有一个从产生到死亡的过程</p><p><img src="http://img.huitoushian.cn/%E5%8D%9A%E5%AE%A2/%E8%BD%AE%E6%92%AD%E5%9B%BE%E5%92%8C%E6%96%87%E7%AB%A0%E9%9A%8F%E6%9C%BA%E5%9B%BE/loading.gif" data-original="http://img.huitoushian.cn/%E5%8D%9A%E5%AE%A2/%E6%96%87%E7%AB%A0/java%E5%A4%9A%E7%BA%BF%E7%A8%8B/d1.png" alt=""></p><ul><li><strong>新建状态：</strong></li></ul><p>　　　　使用new关键字和Thread类或其子类建立一个线程对象后，该线程对象就处于新建状态。它保持这个状态直到程序start()这个线程。</p><ul><li><strong>就绪状态：</strong></li></ul><p>　　　　当线程对象调用了start()方法之后，该线程就进入就绪状态。就绪状态的线程处于就绪队列中，要等待JVM里线程调度器的调度。</p><ul><li><strong>运行状态：</strong></li></ul><p>　　　　如果就绪状态的线程获取CPU资源，就可以执行run(),此时线程便处于运行状态。处于运行状态的线程最为复杂，它可以变为阻塞状态、就绪状态和死亡状态。</p><ul><li><strong>阻塞状态：</strong></li></ul><p>　如果一个线程执行了sleep()、suspend()等方法，失去所占用资源之后，该线程就从运行状态进入阻塞状态。在睡眠时间已到后可以重新进入就绪状态。</p><ul><li><strong>死亡状态：</strong></li></ul><p>　　　　一个运行状态的线程完成任务或者其他终止条件发生时，该线程就切换到终止状态。</p><p><strong>线程的优先级</strong></p><p>每一个 Java 线程都有一个优先级，这样有助于操作系统确定线程的调度顺序。</p><p>Java 线程的优先级是一个整数，其取值范围是1-10。</p><p>默认情况下，每一个线程都会分配一个优先级 (5)。</p><p>具有较高优先级的线程对程序更重要，并且应该在低优先级的线程之前分配处理器资源。但是，线程优先级不能保证线程执行的顺序，而且非常依赖于平台。</p><p><strong>创建线程：</strong></p><p>Java提供了三种创建线程的方法：</p><ul><li>通过实现 Runnable 接口</li><li>通过继承 Thread 类本身</li><li>通过 Callable 和 Future 创建线程</li></ul><h2 id="线程的几个主要概念"><a href="#线程的几个主要概念" class="headerlink" title="线程的几个主要概念"></a>线程的几个主要概念</h2><p>在多线程编程时，你需要了解以下几个概念：</p><h3 id="线程同步synchronized"><a href="#线程同步synchronized" class="headerlink" title="线程同步synchronized"></a>线程同步synchronized</h3><p>一次只能执行一个线程当这个线程执行完毕后 在执行其他线程 ,不会出现同一时间2个线程访问同一个资源的情况</p><h3 id="线程间通信"><a href="#线程间通信" class="headerlink" title="线程间通信"></a>线程间通信</h3><p>线程通讯就是 线程间相互可以访问 监测变量等</p><p>线程通讯分为很多种有while <strong>while轮询的方式</strong> 这样 比较消耗cpu 因为你不断的在检查是否符合 当然你可以使用睡眠 每隔几秒检查一次 这样就不准确了 .</p><p>在java中提供了:</p><p>synchronized关键字结合wait()和notify()及notifyAll()方法的使用可以实现线程的等待与通知模式。在使用notify()、notifyAll()方法进行通知时，被通知的线程是JVM随机选择的。</p><p>1，wait(): 让线程处于冻结状态，被wait的线程会被存储到线程池中。<br>如果对象调用了wait方法就会使持有该对象的线程把该对象的控制权交出去，然后处于等待状态。</p><p>2，notify():唤醒线程池中一个线程(任意)。如果对象调用了notify方法就会通知某个正在等待这个对象的控制权的线程可以继续运行。</p><p>3，notifyAll():唤醒线程池中的所有线程。如果对象调用了notifyAll方法就会通知所有等待这个对象控制权的线程继续运行。</p><p>这些方法都必须定义在同步中。因为这些方法是用于操作线程状态的方法。必须要明确到底操作的是哪个锁上的线程。wait会释放锁,sleep,yield不释放锁</p><p>比如线程 B使用了wait() 放弃CPU并进入阻塞状态 那么在线程A中使用 notify()就能唤醒线程B</p><p>注意wait和notify是Object类的 方法 所以必须加 synchronized同步锁 否则报java.lang.IllegalMonitorStateException</p><p>锁内内容 随意 只要带有对象的都行 或者使用文件.class也行 只要保证睡眠和唤醒用的都是一样的就行</p><p>你锁的时候用的是什么对象 那么使用wait和notify就要用什么 必须对称 否则还是报错</p><p>案例: 生产消费者模式</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Bean</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span>   Integer count<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span>   Integer num<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//1 有鸡   0没鸡</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> Boolean pd<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//线程释放 控制</span>
<span class="token punctuation">}</span>


<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">A</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span>  <span class="token keyword">synchronized</span>    <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">while</span> <span class="token punctuation">(</span>Bean<span class="token punctuation">.</span>pd<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>Bean<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

                <span class="token keyword">if</span> <span class="token punctuation">(</span>Bean<span class="token punctuation">.</span>num <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    Bean<span class="token punctuation">.</span>num<span class="token operator">++</span><span class="token punctuation">;</span>
                    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"生产鸡编号"</span><span class="token operator">+</span><span class="token punctuation">(</span>Bean<span class="token punctuation">.</span>count<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    <span class="token comment" spellcheck="true">// Bean.class 线程阻塞</span>
                    Bean<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token comment" spellcheck="true">// 当满足条件后 就结束线程</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>Bean<span class="token punctuation">.</span>count<span class="token operator">>=</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment" spellcheck="true">//因为鸡从0开始的</span>
                Bean<span class="token punctuation">.</span>pd<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

     <span class="token punctuation">}</span>
<span class="token punctuation">}</span>



 <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">B</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span><span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span>   <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">while</span> <span class="token punctuation">(</span>Bean<span class="token punctuation">.</span>pd<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>Bean<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>Bean<span class="token punctuation">.</span>num <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"买鸡编号"</span> <span class="token operator">+</span><span class="token punctuation">(</span> Bean<span class="token punctuation">.</span>count<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    Bean<span class="token punctuation">.</span>num<span class="token operator">--</span><span class="token punctuation">;</span>
                    Bean<span class="token punctuation">.</span>count<span class="token operator">++</span><span class="token punctuation">;</span>
                    <span class="token comment" spellcheck="true">//唤醒 Bean.class的 阻塞的线程 继续向下执行</span>
                    Bean<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>

        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>



<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">test</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>

                A a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                B b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">B</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            Thread a1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token string">"用户1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            Thread b1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token string">"用户2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            a1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            b1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>测试结果:</p><pre class="line-numbers language-java"><code class="language-java">用户<span class="token number">1</span>生产鸡编号<span class="token number">1</span>
用户<span class="token number">2</span>买鸡编号<span class="token number">1</span>
用户<span class="token number">1</span>生产鸡编号<span class="token number">2</span>
用户<span class="token number">2</span>买鸡编号<span class="token number">2</span>
用户<span class="token number">1</span>生产鸡编号<span class="token number">3</span>
用户<span class="token number">2</span>买鸡编号<span class="token number">3</span>
用户<span class="token number">1</span>生产鸡编号<span class="token number">4</span>
用户<span class="token number">2</span>买鸡编号<span class="token number">4</span>
用户<span class="token number">1</span>生产鸡编号<span class="token number">5</span>
用户<span class="token number">2</span>买鸡编号<span class="token number">5</span>
用户<span class="token number">1</span>生产鸡编号<span class="token number">6</span>
用户<span class="token number">2</span>买鸡编号<span class="token number">6</span>
用户<span class="token number">1</span>生产鸡编号<span class="token number">7</span>
用户<span class="token number">2</span>买鸡编号<span class="token number">7</span>
用户<span class="token number">1</span>生产鸡编号<span class="token number">8</span>
用户<span class="token number">2</span>买鸡编号<span class="token number">8</span>
用户<span class="token number">1</span>生产鸡编号<span class="token number">9</span>
用户<span class="token number">2</span>买鸡编号<span class="token number">9</span>
用户<span class="token number">1</span>生产鸡编号<span class="token number">10</span>
用户<span class="token number">2</span>买鸡编号<span class="token number">10</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="线程死锁"><a href="#线程死锁" class="headerlink" title="线程死锁"></a>线程死锁</h3><p>死锁一般都是线程之间 将对方要锁的东西给锁了 导致资源抢占两方都握有自己的锁不放弃 要想实现死锁，就会有synchronized的嵌套。</p><pre class="line-numbers language-java"><code class="language-java">  <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ThreadResource</span>
  <span class="token punctuation">{</span>
      <span class="token keyword">public</span> <span class="token keyword">static</span> Object resource1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">public</span> <span class="token keyword">static</span> Object resource2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Thread1</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span>
  <span class="token punctuation">{</span>
      <span class="token annotation punctuation">@Override</span>
      <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
         <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>ThreadResource<span class="token punctuation">.</span>resource1<span class="token punctuation">)</span><span class="token punctuation">{</span>
             System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>ThreadResource<span class="token punctuation">.</span>resource2<span class="token punctuation">)</span><span class="token punctuation">{</span>
             <span class="token punctuation">}</span>
         <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Thread2</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span>
  <span class="token punctuation">{</span>
      <span class="token annotation punctuation">@Override</span>
      <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
          <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>ThreadResource<span class="token punctuation">.</span>resource2<span class="token punctuation">)</span><span class="token punctuation">{</span>

              System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

              <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>ThreadResource<span class="token punctuation">.</span>resource1<span class="token punctuation">)</span><span class="token punctuation">{</span>

              <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>

  <span class="token punctuation">}</span>


  <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TEst</span> <span class="token punctuation">{</span>
      <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
          <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Thread1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Thread2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>结果死循环 死哪里了 程序不走了</p><p>从代码中就可以看出来 无论是哪个线程先执行 都会将对方要锁的资源给抢占了</p><p>比如 线程1先执行将resource1, resource2 给锁了执行完后</p><p>线程二执行 线程二将resource2给锁的时候 此刻就会出现问题 线程2将 resource2给锁了 我线程一也要锁 resource2 这样 线程1和线程2就会打架 程序处于死循环状态</p><h3 id="线程控制：挂起，停止和恢复"><a href="#线程控制：挂起，停止和恢复" class="headerlink" title="线程控制：挂起，停止和恢复"></a>线程控制：挂起，停止和恢复</h3><p>1.现在挂起和恢复被遗弃了 现在都是使用 wait和notify</p><p>2.线程停止 使用一个全局静态(true) 来判断 如果满足return 就结束线程了</p><p>3.还有一种是使用java中断标记, 默认就是false; 一般都是用于处理阻塞的</p><pre class="line-numbers language-java"><code class="language-java">     Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">interrupt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//设置线程的中断状态 true</span>
         <span class="token keyword">if</span> <span class="token punctuation">(</span>Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isInterrupted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">//线程是否中断   //true</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"true"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span><span class="token function">interrupted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//返回线程的上次的中断状态，并清除中断状态   //true</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isInterrupted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//false</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>一般来说，阻塞函数，如：Thread.sleep、Thread.join、Object.wait等在检查到线程的中断状态时，会抛出InterruptedException，同时会清除线程的中断状态<br>对于InterruptedException的处理，可以有两种情况：<br>（1）外层代码可以处理这个异常，直接抛出这个异常即可<br>（2）如果不能抛出这个异常，比如在run()方法内，因为在得到这个异常的同时，线程的中断状态已经被清除了，需要保留线程的中断状态，则需要调用Thread.currentThread().interrupt()</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">A</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> count<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span>    <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

                <span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true">//执行5秒后关闭 线程</span>
                        Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">interrupt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//置线程的中断状态 true</span>
                    <span class="token punctuation">}</span>
                    <span class="token keyword">try</span> <span class="token punctuation">{</span>
                        Thread<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                  <span class="token comment" spellcheck="true">//触发异常 此刻中断状态会被设置为false</span>
                        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    
                        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"票抢完了 终止线程"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                         
                        <span class="token keyword">break</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"抢到第"</span> <span class="token operator">+</span> count <span class="token operator">+</span> <span class="token string">"张票"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    count<span class="token operator">--</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"......................"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">test</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        A a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Thread a1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token string">"用户1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Thread a2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token string">"用户2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Thread a3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token string">"用户3"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        a1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        a2<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        a3<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-java"><code class="language-java">  用户<span class="token number">1</span>抢到第<span class="token number">10</span>张票
  用户<span class="token number">1</span>抢到第<span class="token number">9</span>张票
  用户<span class="token number">1</span>抢到第<span class="token number">8</span>张票
  用户<span class="token number">2</span>抢到第<span class="token number">7</span>张票
  用户<span class="token number">2</span>抢到第<span class="token number">6</span>张票
  用户<span class="token number">2</span>抢到第<span class="token number">5</span>张票
  用户<span class="token number">2</span>抢到第<span class="token number">4</span>张票
  用户<span class="token number">2</span>抢到第<span class="token number">3</span>张票
  用户<span class="token number">2</span>抢到第<span class="token number">2</span>张票
  用户<span class="token number">2</span>抢到第<span class="token number">1</span>张票
  票抢完了 终止线程
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
  票抢完了 终止线程
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
  票抢完了 终止线程
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

  java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>InterruptedException<span class="token operator">:</span> sleep interrupted<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>当票抢完了 激活结束标记 然后 抛出异常退出循环 结束线程了</p><p>在java中还有一个已经被遗弃的中断 stop() 这个就不说了 好马不吃回头草</p><h3 id="多线程的使用"><a href="#多线程的使用" class="headerlink" title="多线程的使用"></a>多线程的使用</h3><p>有效利用多线程的关键是理解程序是并发执行而不是串行执行的。例如：程序中有两个子系统需要并发执行，这时候就需要利用多线程编程。</p><p>通过对多线程的使用，可以编写出非常高效的程序。不过请注意，如果你创建太多的线程，程序执行的效率实际上是降低了，而不是提升了。</p><p>请记住，上下文的切换开销也很重要，如果你创建了太多的线程，CPU花费在上下文的切换的时间将多于执行程序的时间！</p><h3 id="多线程的好处"><a href="#多线程的好处" class="headerlink" title="多线程的好处"></a>多线程的好处</h3><p>比如使用 一个app 我打开一个窗口 突然卡主了 但是这个程序的其他窗口都还是可以用的 这就是多线程</p><p>如果单线程 的话 如果这个窗口被卡主了 其他的窗口 就不能用了</p><p>比如测试跑步速度 跑道有4条</p><p>如果用单线程 的话 只能 一个一个测试 如果4个人的话要测试就要测试4次 其他 3个跑道就浪费了 如果多线程 的话 4 个跑道 一起跑 最后 都有结果</p><p>拿代码来说 如果不加同步的话 那么创建2个线程 线程1死循环 线程2随意的输出代码</p><p>当执行线程1死循环后难道 就一直死循环吗 no 不是的 因为线程的调度是由JVM或者说是操作系统来负责的 所以程序也会执行线程2的 只是早晚的问题</p><p>而且你还可以通过其他手段 将线程1给 停止</p><p>多线程作为任务并发的工作方式,有着广泛的应用,合理的运用线程将减少开发和维护的成本,甚至可以改善复杂应用程序的性能,</p><p>使用多线程的优势</p><p>充分利用多cpu的资源, 因为执行单线程程序时候,若程序中断,或者其他情况程序不运行了, cup就会处于空闲情况 ,这就大大的浪费计算机的资源 而多线程 呢就 可以在某个程序执行不正常 的情况 运行其他线程 这样,大大提高了资源的利用率</p><p>比如单线程 如果想执行多个任务 只能利于循环来交替使用如果中间出现什么情况 那么这个程序后面的任务都被卡主了</p><p>而多线程 可以把 程序任务分成 不同时间段 每个时间段执行一个 不论什么情况到时间就会执行下一个 任务 这样程序出现问题不会 直接结束</p><h2 id="多线程的创建"><a href="#多线程的创建" class="headerlink" title="多线程的创建"></a>多线程的创建</h2><p>创建多线程的方法有很多种 但用的最多的也就2种:</p><p>继承Thread类,重写run()方法</p><p>继承Runnable接口,重写run()方法</p><p>这里推荐使用Runnable 因为如果使用了Thread那么就无法继承其他的类了</p><p>注意所有的方法 都要通过run()方法才能运行 因为在多线程中他只会运行run()</p><p>启动线程使用 线程对象.start()方法,如果不 用 star()方法 就是 单线程</p><p>注意一个线程只能使用一次start();</p><p>如果利用循环创建多个线程的话 需要将线程对象 放在循环内 然后在循环体内调用start();</p><p>执行顺序是 在未开启线程前 还是按照单线程的方式执行 直到遇到start();</p><p><strong>Thread类实现多线程</strong></p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyThread</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">10</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">//获取线程当前运行的线程名称 和 i 值</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">":"</span><span class="token operator">+</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>test</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">test</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">//创建3个线程</span>
        MyThread mThread1<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">MyThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mThread1<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">"MyThread1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//设置线程名称</span>
        MyThread mThread2<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">MyThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mThread2<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">"MyThread2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        MyThread myThread3<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">MyThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        myThread3<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">"MyThread3"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">//将3个线程启动</span>
        mThread1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mThread2<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        myThread3<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>观察结果</p><pre class="line-numbers language-java"><code class="language-java">MyThread1<span class="token operator">:</span><span class="token number">0</span>
MyThread3<span class="token operator">:</span><span class="token number">0</span>
MyThread3<span class="token operator">:</span><span class="token number">1</span>
MyThread3<span class="token operator">:</span><span class="token number">2</span>
MyThread3<span class="token operator">:</span><span class="token number">3</span>
MyThread3<span class="token operator">:</span><span class="token number">4</span>
MyThread3<span class="token operator">:</span><span class="token number">5</span>
MyThread3<span class="token operator">:</span><span class="token number">6</span>
MyThread3<span class="token operator">:</span><span class="token number">7</span>
MyThread3<span class="token operator">:</span><span class="token number">8</span>
MyThread3<span class="token operator">:</span><span class="token number">9</span>
MyThread2<span class="token operator">:</span><span class="token number">0</span>
MyThread2<span class="token operator">:</span><span class="token number">1</span>
MyThread2<span class="token operator">:</span><span class="token number">2</span>
MyThread2<span class="token operator">:</span><span class="token number">3</span>
MyThread2<span class="token operator">:</span><span class="token number">4</span>
MyThread2<span class="token operator">:</span><span class="token number">5</span>
MyThread2<span class="token operator">:</span><span class="token number">6</span>
MyThread2<span class="token operator">:</span><span class="token number">7</span>
MyThread2<span class="token operator">:</span><span class="token number">8</span>
MyThread2<span class="token operator">:</span><span class="token number">9</span>
MyThread1<span class="token operator">:</span><span class="token number">1</span>
MyThread1<span class="token operator">:</span><span class="token number">2</span>
MyThread1<span class="token operator">:</span><span class="token number">3</span>
MyThread1<span class="token operator">:</span><span class="token number">4</span>
MyThread1<span class="token operator">:</span><span class="token number">5</span>
MyThread1<span class="token operator">:</span><span class="token number">6</span>
MyThread1<span class="token operator">:</span><span class="token number">7</span>
MyThread1<span class="token operator">:</span><span class="token number">8</span>
MyThread1<span class="token operator">:</span><span class="token number">9</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>没有规律可言</p><p><strong>Runnable()接口实现多线程</strong></p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyThread</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span><span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> count<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span>count<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token comment" spellcheck="true">//将线程暂停0.2秒  运行其他线程</span>
                Thread<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"-当前剩余票数:"</span><span class="token operator">+</span>count<span class="token operator">--</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>test</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">test</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        MyThread Thread1<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">MyThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">//创建3个线程</span>
        Thread mThread1<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>Thread1<span class="token punctuation">,</span><span class="token string">"线程1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Thread mThread2<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>Thread1<span class="token punctuation">,</span><span class="token string">"线程2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Thread mThread3<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>Thread1<span class="token punctuation">,</span><span class="token string">"线程3"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment" spellcheck="true">//将3个线程启动</span>
        mThread1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mThread2<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mThread3<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>观察结果</p><pre class="line-numbers language-java"><code class="language-java">线程<span class="token number">2</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">20</span>
线程<span class="token number">1</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">18</span>
线程<span class="token number">3</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">19</span>
线程<span class="token number">3</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">17</span>
线程<span class="token number">2</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">17</span>
线程<span class="token number">1</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">17</span>
线程<span class="token number">3</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">16</span>
线程<span class="token number">1</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">15</span>
线程<span class="token number">2</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">16</span>
线程<span class="token number">3</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">13</span>
线程<span class="token number">2</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">14</span>
线程<span class="token number">1</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">12</span>
线程<span class="token number">3</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">11</span>
线程<span class="token number">2</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">11</span>
线程<span class="token number">1</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">10</span>
线程<span class="token number">3</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">9</span>
线程<span class="token number">2</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">8</span>
线程<span class="token number">1</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">7</span>
线程<span class="token number">2</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">6</span>
线程<span class="token number">3</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">6</span>
线程<span class="token number">1</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">5</span>
线程<span class="token number">2</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">4</span>
线程<span class="token number">3</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">3</span>
线程<span class="token number">1</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">2</span>
线程<span class="token number">3</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">1</span>
线程<span class="token number">2</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">1</span>
线程<span class="token number">1</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">0</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>通过观察这个结果可以发现 多个线程 都在操作同一个 成员属性 而且抢票的时候多个线程 会发生都抢到同一张票的情况</p><p>比如线程1执行了 但是还没执行到count- -这里,这时候线程2也执行了那么线程1和线程2获取到的就是一样的结果</p><p>甚至有时候 一个线程抢占了绝大部分cpu 导致其他线程就没有执行几次</p><h2 id="多线程中传参"><a href="#多线程中传参" class="headerlink" title="多线程中传参"></a>多线程中传参</h2><p>在多线程中因为 都要统一在run()方法中才能 运行程序 这样就无法使用方法的参数传递了 和 方法的返回值 ,但是换一种思路 ,还是能解决这些问题的.</p><p>传参我们可以使用 构造 和全局静态变量(数组集合,set,javaBean等) ,返回值也一样</p><p><strong>使用构造</strong></p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyThread</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span>  String name<span class="token punctuation">;</span>
    <span class="token keyword">private</span>  <span class="token keyword">int</span> age<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token function">MyThread</span><span class="token punctuation">(</span>String name<span class="token punctuation">,</span> <span class="token keyword">int</span> age<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span>  <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>name<span class="token operator">+</span><span class="token string">"_"</span><span class="token operator">+</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">test</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        MyThread myThread<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">MyThread</span><span class="token punctuation">(</span><span class="token string">"胡"</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        Thread thread1<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>myThread<span class="token punctuation">,</span><span class="token string">"用户1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Thread thread2<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>myThread<span class="token punctuation">,</span><span class="token string">"用户2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        thread1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        thread2<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>使用set</strong></p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">test</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        MyThread myThread<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">MyThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        myThread<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">"hu"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        myThread<span class="token punctuation">.</span><span class="token function">setAge</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        Thread thread1<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>myThread<span class="token punctuation">,</span><span class="token string">"用户1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Thread thread2<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>myThread<span class="token punctuation">,</span><span class="token string">"用户2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        thread1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        thread2<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>javaBean</strong></p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyThread</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>

  <span class="token keyword">private</span>  A  a<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setA</span><span class="token punctuation">(</span>A a<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>a <span class="token operator">=</span> a<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span>  <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"_"</span><span class="token operator">+</span>a<span class="token punctuation">.</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">test</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        MyThread myThread<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">MyThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        A a<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        a<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">"hu"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        a<span class="token punctuation">.</span><span class="token function">setAge</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        myThread<span class="token punctuation">.</span><span class="token function">setA</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>

        Thread thread1<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>myThread<span class="token punctuation">,</span><span class="token string">"用户1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Thread thread2<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>myThread<span class="token punctuation">,</span><span class="token string">"用户2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        thread1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        thread2<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>等等……自己慢慢研究</p><h2 id="多线程中的方法"><a href="#多线程中的方法" class="headerlink" title="多线程中的方法"></a>多线程中的方法</h2><p>线程对象调用的方法</p><table><thead><tr><th><strong>序号</strong></th><th><strong>方法描述</strong></th></tr></thead><tbody><tr><td>1</td><td>public void start() 使该线程开始执行；Java虚拟机调用该线程的 run 方法。</td></tr><tr><td>2</td><td>public void run() 如果该线程是使用独立的 Runnable 运行对象构造的，则调用该 Runnable 对象的run方法；否则，该方法不执行任何操作并返回。</td></tr><tr><td>3</td><td>public final void setName(String name) 改变线程名称，使之与参数 name 相同。</td></tr><tr><td>4</td><td>public final void setPriority(int priority) 更改线程的优先级。</td></tr><tr><td>5</td><td>public final void setDaemon(boolean on) 将该线程标记为守护线程或用户线程。</td></tr><tr><td>6</td><td>public final void join(long millisec) 等待该线程的终止的时间最长为 millis 毫秒。</td></tr><tr><td>7</td><td>public void interrupt() 中断线程。</td></tr><tr><td>8</td><td>public final boolean isAlive() 测试线程是否处于活动状态。</td></tr></tbody></table><p>Thread 类的静态方法</p><table><thead><tr><th><strong>序号</strong></th><th><strong>方法描述</strong></th></tr></thead><tbody><tr><td>1</td><td>public static void yield() 暂停当前正在执行的线程对象，并执行其他线程。</td></tr><tr><td>2</td><td>public static void sleep(long millisec) 在指定的毫秒数内让当前正在执行的线程休眠（暂停执行），此操作受到系统计时器和调度程序精度和准确性的影响。</td></tr><tr><td>3</td><td>public static boolean holdsLock(Object x) 当且仅当当前线程在指定的对象上保持监视器锁时，才返回true.</td></tr><tr><td>4</td><td>public static Thread currentThread() 返回对当前正在执行的线程对象的引用。</td></tr><tr><td>5</td><td>public static void dumpStack() 将当前线程的堆栈跟踪打印至标准错误流。</td></tr></tbody></table><pre class="line-numbers language-java"><code class="language-java"><span class="token comment" spellcheck="true">//在类中想要使用对象方法需要Thread.currentThread()</span>
System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//获取线程名称</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>优先级设置</strong></p><p>线程对象.setPriority(1~10) 默认5</p><p>线程对象.getPriority() 获取优先级</p><p>优先级 设置 有 3个 内部写好 的 常量</p><ol><li><p>默认值=5 Thread.NORM_PRIORITY</p></li><li><p>最大值=10 Thread.MAX_PRIORITY</p></li><li><p>最小值=1 Thread.MIN_PRIORITY</p></li></ol><p>也可以手动输入 int 类型 的数子 在10~1之间</p><p>优先级概念</p><p>当同一时刻有一个或者多个线程处于运行状态时候,他们需要排队等待cpu资源,</p><p>每个线程都会自动获得一个线程的优先级 默认为5 ,优先级的高低反应线程的重要程度或者紧急程度, 那么此刻,如果那个 线程出问题了不能运行了 ,这时候优先级就体现出来了 ,没执行的线程中优先级最高的 先执行 当然这也不是一定的 只是占比率就像你玩游戏 强化装备他说成功率百分之80 但是 还有20几率是不成功的</p><p>一个人骨折了 自己也不知道到底骨折没 到了医院 找到医生 了 医生说 去拍片子 拿来我看 , 这时候 医生 不可能 等 到他拍完片 在 给下一个人看病把,而是根据 优先级 给下一个人看病把 谁先来的给谁看吧 这也不是觉对的 如果医生看某一个人顺眼就先给他看 或者排队的人中有人插队了 ….</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyThread</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span><span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> count<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span>count<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token comment" spellcheck="true">//将线程睡眠0.2秒  运行其他线程</span>
                Thread<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"-当前剩余票数:"</span><span class="token operator">+</span>count<span class="token operator">--</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-java"><code class="language-java">  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        MyThread Thread1<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">MyThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">//创建3个线程</span>
        Thread mThread1<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>Thread1<span class="token punctuation">,</span><span class="token string">"线程1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Thread mThread2<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>Thread1<span class="token punctuation">,</span><span class="token string">"线程2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Thread mThread3<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>Thread1<span class="token punctuation">,</span><span class="token string">"线程3"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        mThread1<span class="token punctuation">.</span><span class="token function">setPriority</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mThread2<span class="token punctuation">.</span><span class="token function">setPriority</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mThread3<span class="token punctuation">.</span><span class="token function">setPriority</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">//将3个线程启动</span>
        mThread1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mThread2<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mThread3<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>观察结果</p><pre class="line-numbers language-java"><code class="language-java">线程<span class="token number">1</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">20</span>
线程<span class="token number">3</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">18</span>
线程<span class="token number">2</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">19</span>
线程<span class="token number">3</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">16</span>
线程<span class="token number">1</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">17</span>
线程<span class="token number">3</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">14</span>
线程<span class="token number">2</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">15</span>
线程<span class="token number">3</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">12</span>
线程<span class="token number">1</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">13</span>
线程<span class="token number">1</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">9</span>
线程<span class="token number">1</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">8</span>
线程<span class="token number">3</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">10</span>
线程<span class="token number">2</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">11</span>
线程<span class="token number">3</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">6</span>
线程<span class="token number">1</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">7</span>
线程<span class="token number">1</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">3</span>
线程<span class="token number">3</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">4</span>
线程<span class="token number">2</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">5</span>
线程<span class="token number">3</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">1</span>
线程<span class="token number">1</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">2</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>虽然程序尽量保证了优先级的 执行顺序 但是 还是免不了插队的 所以所优先级靠不住</p><p>检查线程是否是运行状态</p><pre class="line-numbers language-java"><code class="language-java"> MyThread Thread1<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">MyThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">//创建3个线程</span>
        Thread mThread1<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>Thread1<span class="token punctuation">,</span><span class="token string">"线程1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Thread mThread2<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>Thread1<span class="token punctuation">,</span><span class="token string">"线程2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Thread mThread3<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>Thread1<span class="token punctuation">,</span><span class="token string">"线程3"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span> mThread1<span class="token punctuation">.</span><span class="token function">isAlive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span> mThread2<span class="token punctuation">.</span><span class="token function">isAlive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span> mThread3<span class="token punctuation">.</span><span class="token function">isAlive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">//将3个线程启动</span>
        mThread1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mThread2<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mThread3<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span> mThread1<span class="token punctuation">.</span><span class="token function">isAlive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span> mThread2<span class="token punctuation">.</span><span class="token function">isAlive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span> mThread3<span class="token punctuation">.</span><span class="token function">isAlive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>结果</p><p>false<br>false<br>false<br>true<br>true<br>true</p><p>如果线程还在运行则返回true，否则返回false.</p><h2 id="sleep-join-yield"><a href="#sleep-join-yield" class="headerlink" title="sleep   join  yield"></a>sleep join yield</h2><p>sleep执行后线程进入<strong>睡眠状态</strong></p><p>yield执行后线程进入<strong>就绪状态</strong></p><p>join执行后线程进入<strong>阻塞状态</strong></p><p>sleep 他就是让当前线程睡眠而且 让其他线程执行</p><p>这里注意 如果加上锁后 就算当前线程睡眠其他的 线程也不会执行</p><pre><code>  try {
            //将线程睡眠0.2秒  运行其他线程
            Thread.sleep(200);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }</code></pre><p>join 就是阻拦其他线程运行 只有当前线程运行完后其他线程才会执行</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyThread</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span><span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">int</span> count<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span>count<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"-当前剩余票数:"</span><span class="token operator">+</span>count<span class="token operator">--</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">test</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        MyThread Thread1<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">MyThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">//创建3个线程</span>
        Thread mThread1<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>Thread1<span class="token punctuation">,</span><span class="token string">"线程1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Thread mThread2<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>Thread1<span class="token punctuation">,</span><span class="token string">"线程2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Thread mThread3<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>Thread1<span class="token punctuation">,</span><span class="token string">"线程3"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment" spellcheck="true">//将3个线程启动</span>
        mThread1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">//阻塞其他线程 当前前线程运行完 后恢复 </span>
            mThread1<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        mThread2<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
              <span class="token comment" spellcheck="true">//阻塞其他线程 当前前线程运行完 后恢复 </span>
            mThread2<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        mThread3<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>观察结果</p><pre class="line-numbers language-java"><code class="language-java">线程<span class="token number">1</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">5</span>
线程<span class="token number">1</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">4</span>
线程<span class="token number">1</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">3</span>
线程<span class="token number">1</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">2</span>
线程<span class="token number">1</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">1</span>
线程<span class="token number">2</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">5</span>
线程<span class="token number">2</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">4</span>
线程<span class="token number">2</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">3</span>
线程<span class="token number">2</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">2</span>
线程<span class="token number">2</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">1</span>
线程<span class="token number">3</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">5</span>
线程<span class="token number">3</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">4</span>
线程<span class="token number">3</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">3</span>
线程<span class="token number">3</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">2</span>
线程<span class="token number">3</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">1</span>

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>join还有一种是加上时间 意思就是 在这段时间内 将其他线程阻塞 只执行我的线程</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">A</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span>    <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">int</span> count<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">;</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span>count<span class="token operator">>=</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            count<span class="token operator">--</span><span class="token punctuation">;</span>
                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"___"</span><span class="token operator">+</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    Thread<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">test</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        A a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Thread a1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token string">"用户1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Thread a2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token string">"用户2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Thread a3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token string">"用户3"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        a1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            a1<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        a2<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        a3<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><em>我这里阻塞其他线程2秒 我的代码内设置了500毫秒运行一次也就是在2秒内这个线程必定会执行4次 然后就恢复其他的线程开始继续并发</em></p><p>yield 就是当一个线程抢到执行权后，执行到yield（）方法后，就会放弃执行权，其他线程就可以拿到执行权 了 不是绝对的,但有可能没有效果。 因为，让步的线程可能被线程调度程序再次选中。(所以呵呵就行了)</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyThread</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span><span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">int</span> count<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span>count<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>count<span class="token operator">==</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token function">yield</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"礼让"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"-当前剩余票数:"</span><span class="token operator">+</span>count<span class="token operator">--</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">test</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        MyThread Thread1<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">MyThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">//创建3个线程</span>
        Thread mThread1<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>Thread1<span class="token punctuation">,</span><span class="token string">"线程1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Thread mThread2<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>Thread1<span class="token punctuation">,</span><span class="token string">"线程2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Thread mThread3<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>Thread1<span class="token punctuation">,</span><span class="token string">"线程3"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">//将3个线程启动</span>
        mThread1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mThread2<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mThread3<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>观察结果</p><pre class="line-numbers language-java"><code class="language-java">线程<span class="token number">1</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">5</span>
线程<span class="token number">1</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">4</span>
线程<span class="token number">2</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">5</span>
线程<span class="token number">2</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">4</span>
线程<span class="token number">3</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">5</span>
线程<span class="token number">1</span>礼让
线程<span class="token number">1</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">3</span>
线程<span class="token number">1</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">2</span>
线程<span class="token number">1</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">1</span>
线程<span class="token number">3</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">4</span>
线程<span class="token number">2</span>礼让
线程<span class="token number">3</span>礼让
线程<span class="token number">2</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">3</span>
线程<span class="token number">2</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">2</span>
线程<span class="token number">2</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">1</span>
线程<span class="token number">3</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">3</span>
线程<span class="token number">3</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">2</span>
线程<span class="token number">3</span><span class="token operator">-</span>当前剩余票数<span class="token operator">:</span><span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>可以发现我礼让了 但是下次执行的有可能 还是我 因为你将执行权限返回给 系统了但是系统 还是有几率在抽到你 (没什么卵用)</p><h2 id="synchronized-悲壮锁"><a href="#synchronized-悲壮锁" class="headerlink" title="synchronized(悲壮锁)"></a>synchronized(悲壮锁)</h2><p>Synchronized被称为同步锁，它的作用是保证一段代码在同一时间只能被一个线程执行，它是如何做到的呢？</p><p>monitor对象是同步工具，线程在执行Synchronized的代码段的时候要先去获取对象的monitor,执行完毕释放monitor。一次只能有一个线程获取monitor,只有该线程释放monitor以后其它线程才能再获取它。</p><p>当对某一段代码加上Synchronized关键字以后这段代码虽然拥有了线程安全性，但是效率也明显下降，如何在两者之间寻求平衡，</p><p>在java1.6之后Synchronized进行了一些优化，引入了偏向锁、轻量级锁、重量级锁。</p><p><strong>偏向锁</strong></p><p>在很多情况下，虽然我们加了Synchronized关键字，保证了它的线程安全性，但是在实际当中多数情况下只有一个线程运行这段代码，并没有其它线程来和它竞争。这一个线程每次执行代码都需要获取锁和释放锁这个开销是没有必要的。所以引入了偏向锁，偏向锁在一个线程第一次访问的时候将该线程的id记录下来，下次判断如果还是该线程就不会加锁了。如果有另一个线程也来访问它，说明有可能出现线程并发。此时偏向锁就会升级为轻量级锁。</p><p>简单来说就是,单个线程</p><p><strong>轻量级锁</strong></p><p>如果有多个线程来访问这段代码，偏向锁会升级为轻量级锁，此时的线程是交替执行，一旦一个线程执行加锁的代码段,另一个线程也需要<strong>执行加锁的代码段</strong>，另一个线程就会形成竞争，首先会自旋，自旋一段时间后或者超过指定次数 轻量级锁升级为重量级锁。</p><p>什么是自旋?</p><p>计算机系统资源总是有限的，有些资源需要互斥访问，因此就有了锁机制，只有获得锁的线程才能访问资源。锁保证了每次只有一个线程可以访问资源。当线程申请一个已经被其他线程占用的锁，就会出现两种情况。一种是没有获得锁的线程会阻塞自己，等到锁被释放后再被唤起，这就是互斥锁；另一种是没有获得锁的线程一直循环在那里看是否该锁的保持者已经释放了锁 如果释放了就获取资源，这就是自旋锁。</p><p>虽然自旋锁效率比互斥锁高，但它会占用大量cpu资源</p><p><strong>重量级锁</strong></p><p>一时间只能允许一个线程执行，此时如果有另一个线程也要执行这段代码就会被阻塞，挂起，线程执行完后，其他的线程才会被唤醒，这些动作都是，很消耗资源,</p><p>而实现以上原理是使用 monitor来完成的 也就是到这一步就回到1.6之前的锁状态了</p><hr><p>被上锁的代码或者方法 都变成是 原子性(不可分隔)</p><p>synchronized线程限制 有两种方法</p><ol><li>方法锁</li><li>代码块锁</li></ol><p>先 介绍下 synchronized 是干什么的 怎么处理方式</p><p>如果不使用线程限制 在多线程并发的情况下 多个线程同时运行 的话 就会出现一个任务被多个线程同时访问到 的情况</p><p>就比如 一个大房间有很多小房间 但是就只有 一把钥匙 只能 一个人进去 后 办完事钥匙还了 其他的人才能 拿着钥匙在进去</p><p>用代码来说就是某一个线程拿到了钥匙进入到synchronized修饰的代码里 那么其他线程就需要在synchronized外面挂起,等待这个线程执行完释放钥匙,然后钥匙会随机给一个线程 ,此刻其他线程中某一个拿到钥匙的线程,就会被唤醒,然后进入synchronized修饰的代码里,以此类推………………</p><p>省略代码<br>……………….. 10张票 3人抢</p><pre class="line-numbers language-java"><code class="language-java">
用户<span class="token number">2</span>抢到第<span class="token number">10</span>票
用户<span class="token number">3</span>抢到第<span class="token number">10</span>票
用户<span class="token number">1</span>抢到第<span class="token number">10</span>票
用户<span class="token number">3</span>抢到第<span class="token number">8</span>票
用户<span class="token number">2</span>抢到第<span class="token number">9</span>票
用户<span class="token number">2</span>抢到第<span class="token number">5</span>票
用户<span class="token number">3</span>抢到第<span class="token number">6</span>票
用户<span class="token number">1</span>抢到第<span class="token number">7</span>票
用户<span class="token number">1</span>抢到第<span class="token number">2</span>票
用户<span class="token number">3</span>抢到第<span class="token number">3</span>票
用户<span class="token number">2</span>抢到第<span class="token number">4</span>票
用户<span class="token number">1</span>抢到第<span class="token number">1</span>票<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>就会出现这样的结果 多个线程 交互 同时访问一个数据 这就造成了 数据混乱 多个人还同时抢到同一张票的情况 本来就10张票 这一下多出来2张了哪来的?</p><p>为了解决这个问题是要添加方法锁</p><p><strong>方法锁</strong></p><p>就是让线程在方法那个地方挂起 只让一个线程进入 等这个线程执行完或者线程调度器切换后 其他线程才能执行</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyThread</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span>    <span class="token keyword">int</span> p<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//10张票</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span>  <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">p</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">synchronized</span>  <span class="token keyword">boolean</span>   <span class="token function">p</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>p<span class="token operator">&lt;=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
           <span class="token punctuation">}</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"抢到第"</span><span class="token operator">+</span>p<span class="token operator">+</span><span class="token string">"票"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        p<span class="token operator">--</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">test</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        MyThread myThread<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">MyThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        Thread thread1<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>myThread<span class="token punctuation">,</span><span class="token string">"用户1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Thread thread2<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>myThread<span class="token punctuation">,</span><span class="token string">"用户2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Thread thread3<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>myThread<span class="token punctuation">,</span><span class="token string">"用户3"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        thread1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        thread2<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        thread3<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>结果:</p><pre class="line-numbers language-java"><code class="language-java">用户<span class="token number">1</span>抢到第<span class="token number">10</span>票
用户<span class="token number">1</span>抢到第<span class="token number">9</span>票
用户<span class="token number">1</span>抢到第<span class="token number">8</span>票
用户<span class="token number">1</span>抢到第<span class="token number">7</span>票
用户<span class="token number">3</span>抢到第<span class="token number">6</span>票
用户<span class="token number">3</span>抢到第<span class="token number">5</span>票
用户<span class="token number">3</span>抢到第<span class="token number">4</span>票
用户<span class="token number">3</span>抢到第<span class="token number">3</span>票
用户<span class="token number">3</span>抢到第<span class="token number">2</span>票
用户<span class="token number">3</span>抢到第<span class="token number">1</span>票<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>可以发现并没有出现 用户想重复的票 如果资源太少 程序运行太快线程调度器没有及时切换,有可能出现一个用户把票全抢完了</p><p><strong>代码快锁</strong></p><p>就是让线程 卡在synchronized(this)代码块哪里 只能一个进入 和方法锁限制一样</p><p>除了代码块外其他代码 都正常 被多线程并发同时访问</p><pre class="line-numbers language-java"><code class="language-java">
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyThread</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span>    <span class="token keyword">int</span> p<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//10张票</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span>  <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>p<span class="token operator">&lt;=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                        <span class="token keyword">break</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"抢到第"</span><span class="token operator">+</span>p<span class="token operator">+</span><span class="token string">"票"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                  p<span class="token operator">--</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">test</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        MyThread myThread<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">MyThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        Thread thread1<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>myThread<span class="token punctuation">,</span><span class="token string">"用户1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Thread thread2<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>myThread<span class="token punctuation">,</span><span class="token string">"用户2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Thread thread3<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>myThread<span class="token punctuation">,</span><span class="token string">"用户3"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        thread1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        thread2<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        thread3<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>结果:</p><pre class="line-numbers language-java"><code class="language-java">用户<span class="token number">1</span>抢到第<span class="token number">10</span>票
用户<span class="token number">1</span>抢到第<span class="token number">9</span>票
用户<span class="token number">3</span>抢到第<span class="token number">8</span>票
用户<span class="token number">3</span>抢到第<span class="token number">7</span>票
用户<span class="token number">3</span>抢到第<span class="token number">6</span>票
用户<span class="token number">3</span>抢到第<span class="token number">5</span>票
用户<span class="token number">3</span>抢到第<span class="token number">4</span>票
用户<span class="token number">3</span>抢到第<span class="token number">3</span>票
用户<span class="token number">3</span>抢到第<span class="token number">2</span>票
用户<span class="token number">3</span>抢到第<span class="token number">1</span>票<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>注意synchronized(this)代码块外的代码并没有被锁 还是处于并发状态</p><p><strong>一定要注意的地方 否则锁不住</strong></p><p>1、synchronized加在非静态方法前和使用synchronized(this)代码块 都是锁住了这个类的对象，如果多线程访问，多个线程对象类型不同，就锁不住，多个线程对象是同类型，就可锁住。</p><p>2、synchronized(类名.class)和静态锁 锁的是类 而不是对象 不管多线程访问的时候线程类型是不是同一个 只要调用这个被同步的方法或者运行到代码块位置 都会被锁住，能缩小代码段的范围就尽量缩小，能在代码段上加同步就不要再整个方法上加同步，尽量缩小锁的粒度。</p><p>根据上面两点总结 尽量使用 synchronized (test.class) 和静态方法锁</p><p>不要使用普通方法锁和synchronized (this) synchronized (obj)</p><p>正确用法 在静态方法上使用 synchronized修饰 或者 synchronized (类.class)代码块</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">test</span> <span class="token keyword">implements</span>  <span class="token class-name">Runnable</span><span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span>    <span class="token keyword">int</span> num<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span>  <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>test<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">int</span> a<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i1 <span class="token operator">&lt;</span> a<span class="token punctuation">;</span> i1<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                num<span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> a<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">;</span>
        test t<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> a<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            Thread<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">//结果1000000万</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>还有一种方式是双重锁用的很少</p><pre class="line-numbers language-java"><code class="language-java">    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">synchronized</span>   <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">synchronized</span>   <span class="token keyword">void</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
         <span class="token comment" spellcheck="true">///代码  1</span>
        <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>test<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">///代码  2</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这种锁的原理就跟if else 一样 如果是同一个对象线程 那么线程进入show()时候就进入同步</p><p>如果线程不是同一个对象那么show()方法 不实现同步 会执行代码1 然后 遇到 synchronized (test.class)就会进入同步</p><h2 id="Lock锁"><a href="#Lock锁" class="headerlink" title="Lock锁"></a>Lock锁</h2><h3 id="lock使用方法"><a href="#lock使用方法" class="headerlink" title="lock使用方法"></a>lock使用方法</h3><p>在Java多线程中，可以使用synchronized关键字实现线程之间的同步互斥，在jdk1.5后新增的ReentrantLock类同样可达到此效果，且在使用上比synchronized更加灵活。</p><p>创建成员属性 <code>private Lock lock = new ReentrantLock();</code></p><p>在需要锁的代码前加上<code>lock.lock();</code> 进行上锁</p><p>在需要锁的代码结束位置<code>lock.unlock();</code> 释放锁</p><p>使用lock的使用 尽量使用try catch finally</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>locks<span class="token punctuation">.</span>Lock<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>locks<span class="token punctuation">.</span>ReentrantLock<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyThread</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span>  <span class="token keyword">static</span>  Integer num<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> Lock lock <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ReentrantLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
                lock<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//上锁</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>num<span class="token operator">&lt;=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                  <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"___"</span><span class="token operator">+</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>
            num<span class="token operator">--</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            lock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//释放锁</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-java"><code class="language-java">
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        MyThread myThread <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>myThread <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="使用Condition实现等待-通知"><a href="#使用Condition实现等待-通知" class="headerlink" title="使用Condition实现等待/通知"></a>使用Condition实现等待/通知</h3><p>synchronized关键字结合wait()和notify()及notifyAll()方法的使用可以实现线程的等待与通知模式。在使用notify()、notifyAll()方法进行通知时，被通知的线程是JVM随机选择的。</p><p>类ReentrantLock类同样可以实现该功能，需要借助Condition对象，可实现“选择性通知”。Condition类是jdk1.5提供的，且在一个Lock对象中可以创建多个Condition(对象监视器)实例。</p><pre class="line-numbers language-java"><code class="language-java"><span class="token comment" spellcheck="true">/*
 * 使用Conditimport java.util.concurrent.locks.Condition;
import java.util.concurrent.locks.Lock;
import java.util.concurrent.locks.ReentrantLock;

public class MyThread implements Runnable {
    /*
     * 使用Condition实现等待、通知
     * */</span>
    <span class="token keyword">private</span> Lock lock <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ReentrantLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> Condition condition <span class="token operator">=</span> lock<span class="token punctuation">.</span><span class="token function">newCondition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">//上锁</span>
            lock<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">" 开始等待时间："</span> <span class="token operator">+</span> System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"我陷入了等待..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">//线程等待</span>
            condition<span class="token punctuation">.</span><span class="token function">await</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"被唤醒..........."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">//释放锁</span>
            lock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"锁释放了!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">//通知方法</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">signal</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">////上锁</span>
            lock<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"结束等待时间："</span> <span class="token operator">+</span> System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">//唤醒 等待 线程</span>
            condition<span class="token punctuation">.</span><span class="token function">signal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            lock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//释放锁</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"signal锁释放了!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>


    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> InterruptedException <span class="token punctuation">{</span>
        MyThread myCondition <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Thread thread1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>myCondition<span class="token punctuation">,</span> <span class="token string">"线程1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        thread1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Thread<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        myCondition<span class="token punctuation">.</span><span class="token function">signal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


<span class="token punctuation">}</span>
ion实现等待、通知
 <span class="token operator">*</span> <span class="token operator">*</span><span class="token operator">/</span>
<span class="token keyword">class</span> <span class="token class-name">MyCondition</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span><span class="token punctuation">{</span>
    <span class="token keyword">private</span> Lock lock <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ReentrantLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> Condition condition <span class="token operator">=</span> lock<span class="token punctuation">.</span><span class="token function">newCondition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">//上锁</span>
            lock<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">" 开始等待时间："</span><span class="token operator">+</span>System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"我陷入了等待..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">//线程等待</span>
            condition<span class="token punctuation">.</span><span class="token function">await</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">//释放锁</span>
            lock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"锁释放了!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment" spellcheck="true">//通知方法</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">signal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">////上锁</span>
            lock<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"结束等待时间："</span><span class="token operator">+</span>System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token comment" spellcheck="true">//通知等待线程</span>
            condition<span class="token punctuation">.</span><span class="token function">signal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            lock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//释放锁</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyLock</span><span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> InterruptedException <span class="token punctuation">{</span>
        MyCondition myCondition <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyCondition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Thread thread1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>myCondition<span class="token punctuation">,</span><span class="token string">"线程1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        thread1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Thread<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        myCondition<span class="token punctuation">.</span><span class="token function">signal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-java"><code class="language-java">  Object类中的<span class="token function">wait</span><span class="token punctuation">(</span><span class="token keyword">long</span> timeout<span class="token punctuation">)</span>方法等同于Condition类中的<span class="token function">await</span><span class="token punctuation">(</span><span class="token keyword">long</span> time<span class="token punctuation">,</span>TimeUnit unit<span class="token punctuation">)</span>方法。

            Object类中的<span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span>方法等同于Condition类中的<span class="token function">singal</span><span class="token punctuation">(</span><span class="token punctuation">)</span>方法。

           Object类中的<span class="token function">notifyAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>方法等同于Condition类中的<span class="token function">singalAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>方法。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="公平锁与非公平锁"><a href="#公平锁与非公平锁" class="headerlink" title="公平锁与非公平锁"></a><strong>公平锁与非公平锁</strong></h3><p>锁Lock分为“公平锁”和“非公平锁”。</p><p>公平锁：表示线程获取锁的顺序是按照线程加锁的顺序来的进行分配的，即先来先得FIFO先进先出顺序。 (true) 不会出现一个线程执行多次的结果</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>locks<span class="token punctuation">.</span>Condition<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>locks<span class="token punctuation">.</span>Lock<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>locks<span class="token punctuation">.</span>ReentrantLock<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyThread</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span>  <span class="token keyword">static</span>  Integer num<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> ReentrantLock lock<span class="token punctuation">;</span>
    <span class="token keyword">public</span>  <span class="token function">MyThread</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> isFair<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        lock <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ReentrantLock</span><span class="token punctuation">(</span>isFair<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                lock<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//上锁</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>num<span class="token operator">&lt;=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"___"</span><span class="token operator">+</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>
                num<span class="token operator">--</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
                lock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//释放锁</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-java"><code class="language-java">    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        MyThread myThread <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyThread</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Runnable<span class="token punctuation">)</span> myThread<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>Thread-1___1000
Thread-2___999
Thread-0___998
Thread-1___997
Thread-2___996
Thread-0___995
Thread-1___994
Thread-2___993
Thread-0___992</code></pre><p>非公平锁(默认)：一种获取锁的抢占机制，是随机拿到锁的，和公平锁不一样的是先来的不一定先拿到锁，这个方式可能造成某些线程一直拿不到锁，结果就是不公平的·。 (false)</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">//默认或者设置当前为false</span>
        <span class="token keyword">final</span> MyService myService <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyService</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-java"><code class="language-java">    <span class="token keyword">private</span> ReentrantLock lock<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token function">MyService</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> isFair<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        lock <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ReentrantLock</span><span class="token punctuation">(</span>isFair<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>类似于这种</p><pre><code>Thread-0___1000
Thread-0___999
Thread-0___998
Thread-0___997
Thread-0___996
Thread-0___995
Thread-0___994</code></pre><p>其他线程有可能一直拿不到锁</p><h3 id="读写锁表示两个锁："><a href="#读写锁表示两个锁：" class="headerlink" title="读写锁表示两个锁："></a><strong>读写锁表示两个锁：</strong></h3><p>主要的作用我们会有一种需求，在对数据进行读写的时候，为了保证数据的一致性和完整性</p><p>需要读和写是互斥的，写和写是互斥的，但是读和读是不需要互斥的，这样读和读不互斥性能更高些</p><p><code>private ReentrantReadWriteLock lock = new ReentrantReadWriteLock();</code></p><p>支持公平锁</p><p>读操作相关的锁，也成为共享锁。 和没锁一样</p><p><code>lock.readLock().lock();</code> 读锁</p><p><code>lock.readLock().unlock();</code>释放读锁</p><p>同一时间允许多个线程执行lock()后的代码</p><p>写操作相关的锁，也叫排他锁。 和同步一个原理</p><p><code>lock.writeLock().lock();</code> 写锁</p><p><code>lock.writeLock().unlock();</code>释放写锁</p><p>同一时间只允许一个线程执行lock()后的代码。</p><p>未使用读写锁</p><pre><code>Thread-2 have read data: 1000
Thread-3 have read data: 1000
Thread-6 have read data: 999
Thread-1 have read data: 1000
Thread-0 have read data: 1000
Thread-5 have read data: 995
Thread-8 have read data: 995
Thread-4 have read data: 995
Thread-10 have read data: 993
Thread-7 have read data: 994
Thread-9 have read data: 991
Thread-11 have read data: 992</code></pre><p>读取了修改前的数据了 因为我在写的过程中还能被其他线程读取到数据</p><p>解决办法使用了读写锁 让读写分离</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">test</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span>  <span class="token keyword">static</span> Integer data <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//共享数据，只能有一个线程能写该数据，但可以有多个线程同时读</span>
  <span class="token keyword">static</span>   ReadWriteLock  lock <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ReentrantReadWriteLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">1000</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    
            <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token annotation punctuation">@Override</span>
                <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">try</span> <span class="token punctuation">{</span>
                        lock<span class="token punctuation">.</span><span class="token function">readLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">" have read data: "</span><span class="token operator">+</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span><span class="token keyword">finally</span><span class="token punctuation">{</span>
                        lock<span class="token punctuation">.</span><span class="token function">readLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token keyword">try</span> <span class="token punctuation">{</span>
                        lock<span class="token punctuation">.</span><span class="token function">writeLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        data <span class="token operator">=</span> data<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
                        lock<span class="token punctuation">.</span><span class="token function">writeLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>Thread-11 have read data: 991
Thread-13 have read data: 991
Thread-10 have read data: 991
Thread-14 have read data: 991
Thread-12 have read data: 991
Thread-23 have read data: 991
Thread-29 have read data: 988
Thread-18 have read data: 988
Thread-31 have read data: 986
Thread-32 have read data: 986
Thread-20 have read data: 986
Thread-33 have read data: 986
Thread-19 have read data: 986
Thread-25 have read data: 980
Thread-37 have read data: 978</code></pre><p>可以看出来了吧</p><h2 id="炫舞案例"><a href="#炫舞案例" class="headerlink" title="炫舞案例:"></a>炫舞案例:</h2><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Game_content</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">//游戏内容</span>

    <span class="token keyword">final</span> <span class="token keyword">static</span> String<span class="token punctuation">[</span><span class="token punctuation">]</span> neir<span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"w"</span><span class="token punctuation">,</span><span class="token string">"d"</span><span class="token punctuation">,</span><span class="token string">"a"</span><span class="token punctuation">,</span><span class="token string">"s"</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">static</span> <span class="token keyword">public</span>  StringBuffer  <span class="token function">gain</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        StringBuffer c<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">StringBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> j<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">int</span> random1<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            c<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>neir<span class="token punctuation">[</span>random1<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span>  c<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Monitoring</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">//监控</span>


    <span class="token keyword">public</span> <span class="token keyword">volatile</span> <span class="token keyword">boolean</span> exit <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//定义线程公有属性  用于同时操作多个线程的开关</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> time<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//定义游戏完成时间</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>Record<span class="token punctuation">.</span>jb<span class="token operator">>=</span><span class="token number">3</span><span class="token operator">&amp;&amp;</span> Record<span class="token punctuation">.</span>jb<span class="token operator">&lt;=</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            time<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>Record<span class="token punctuation">.</span>jb<span class="token operator">>=</span><span class="token number">5</span><span class="token operator">&amp;&amp;</span> Record<span class="token punctuation">.</span>jb<span class="token operator">&lt;=</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            time<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>Record<span class="token punctuation">.</span>jb<span class="token operator">>=</span><span class="token number">7</span><span class="token operator">&amp;&amp;</span> Record<span class="token punctuation">.</span>jb<span class="token operator">&lt;=</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            time<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>Record<span class="token punctuation">.</span>jb<span class="token operator">>=</span><span class="token number">9</span><span class="token operator">&amp;&amp;</span> Record<span class="token punctuation">.</span>jb<span class="token operator">&lt;=</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            time<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        Record<span class="token punctuation">.</span>TimeSum<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span>time<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>exit<span class="token operator">==</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">//关闭线程</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                Thread<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                Record<span class="token punctuation">.</span>TimeSum<span class="token operator">++</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//计时</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>Record<span class="token punctuation">.</span>TimeSum<span class="token operator">==</span>time<span class="token operator">&amp;&amp;</span>exit<span class="token operator">!=</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"超时游戏结束,你一共获得的积分:"</span><span class="token operator">+</span> Record<span class="token punctuation">.</span>jif<span class="token punctuation">)</span><span class="token punctuation">;</span>
                Record<span class="token punctuation">.</span>time<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//关闭主线程的其他操作</span>
                Record<span class="token punctuation">.</span>pd<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//关闭主线程循环 让程序结束</span>
            <span class="token punctuation">}</span>

        <span class="token punctuation">}</span>


    <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Record</span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">//记录</span>


    <span class="token keyword">static</span> <span class="token keyword">int</span> jif<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//积分</span>
    <span class="token keyword">static</span> <span class="token keyword">int</span> time<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//计时</span>
    <span class="token keyword">static</span> <span class="token keyword">int</span> TimeSum<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//一共用时</span>
    <span class="token keyword">static</span> <span class="token keyword">int</span>  jb<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//级别</span>
    <span class="token keyword">static</span> <span class="token keyword">boolean</span> pd<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//游戏循环</span>


<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Scanner<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">test</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Scanner in<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Scanner</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>in<span class="token punctuation">)</span><span class="token punctuation">;</span>

        Game_content content<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Game_content</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> rank <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>



        <span class="token keyword">while</span><span class="token punctuation">(</span>Record<span class="token punctuation">.</span>pd<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">//判断级别</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>Record<span class="token punctuation">.</span>jif<span class="token operator">>=</span><span class="token number">5</span><span class="token operator">&amp;&amp;</span> Record<span class="token punctuation">.</span>jif<span class="token operator">&lt;</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                rank<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">;</span>
                Record<span class="token punctuation">.</span>jb<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>Record<span class="token punctuation">.</span>jif<span class="token operator">>=</span><span class="token number">10</span><span class="token operator">&amp;&amp;</span> Record<span class="token punctuation">.</span>jif<span class="token operator">&lt;</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                rank<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">;</span>
                Record<span class="token punctuation">.</span>jb<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>Record<span class="token punctuation">.</span>jif<span class="token operator">>=</span><span class="token number">15</span><span class="token operator">&amp;&amp;</span> Record<span class="token punctuation">.</span>jif<span class="token operator">&lt;</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                rank<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">;</span>
                Record<span class="token punctuation">.</span>jb<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>Record<span class="token punctuation">.</span>jif<span class="token operator">>=</span><span class="token number">20</span><span class="token operator">&amp;&amp;</span> Record<span class="token punctuation">.</span>jif<span class="token operator">&lt;</span><span class="token number">25</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                rank<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">;</span>
                Record<span class="token punctuation">.</span>jb<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>Record<span class="token punctuation">.</span>jif<span class="token operator">>=</span><span class="token number">25</span><span class="token operator">&amp;&amp;</span> Record<span class="token punctuation">.</span>jif<span class="token operator">&lt;</span><span class="token number">30</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                rank<span class="token operator">=</span><span class="token number">9</span><span class="token punctuation">;</span>
                Record<span class="token punctuation">.</span>jb<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">;</span>

            <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>Record<span class="token punctuation">.</span>jif<span class="token operator">>=</span><span class="token number">30</span><span class="token operator">&amp;&amp;</span> Record<span class="token punctuation">.</span>jif<span class="token operator">&lt;</span><span class="token number">35</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                rank<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">;</span>
                Record<span class="token punctuation">.</span>jb<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>Record<span class="token punctuation">.</span>jif<span class="token operator">>=</span><span class="token number">35</span><span class="token operator">&amp;&amp;</span> Record<span class="token punctuation">.</span>jif<span class="token operator">&lt;</span><span class="token number">40</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                rank<span class="token operator">=</span><span class="token number">11</span><span class="token punctuation">;</span>
                Record<span class="token punctuation">.</span>jb<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>Record<span class="token punctuation">.</span>jif<span class="token operator">>=</span><span class="token number">40</span><span class="token operator">&amp;&amp;</span> Record<span class="token punctuation">.</span>jif<span class="token operator">&lt;</span><span class="token number">45</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                rank<span class="token operator">=</span><span class="token number">13</span><span class="token punctuation">;</span>
                Record<span class="token punctuation">.</span>jb<span class="token operator">=</span><span class="token number">9</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>Record<span class="token punctuation">.</span>jif<span class="token operator">>=</span><span class="token number">45</span><span class="token operator">&amp;&amp;</span> Record<span class="token punctuation">.</span>jif<span class="token operator">&lt;</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                rank<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">;</span>
                Record<span class="token punctuation">.</span>jb<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>


            String c<span class="token operator">=</span>content<span class="token punctuation">.</span><span class="token function">gain</span><span class="token punctuation">(</span>rank<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"现在游戏级别是"</span><span class="token operator">+</span> Record<span class="token punctuation">.</span>jb<span class="token operator">+</span><span class="token string">"\n"</span><span class="token operator">+</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
            Monitoring monitoring<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Monitoring</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            Thread thread<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>monitoring<span class="token punctuation">)</span><span class="token punctuation">;</span>
            thread<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            String s<span class="token operator">=</span>in<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>Record<span class="token punctuation">.</span>time<span class="token operator">!=</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    Record<span class="token punctuation">.</span>jif<span class="token operator">++</span><span class="token punctuation">;</span>
                    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"用时"</span><span class="token operator">+</span> Record<span class="token punctuation">.</span>TimeSum<span class="token operator">+</span><span class="token string">"秒"</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
                    s<span class="token operator">=</span>null<span class="token punctuation">;</span>
                    monitoring<span class="token punctuation">.</span>exit<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>

                <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>

                    Record<span class="token punctuation">.</span>pd<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span>
                    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"输入错误 ,游戏结束,你一共获得的积分:"</span><span class="token operator">+</span> Record<span class="token punctuation">.</span>jif<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    monitoring<span class="token punctuation">.</span>exit<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>

        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>当超时后为什么 控制台没有被关闭 因为 线程 在任意情况下都在监控你 是否超时</p><p>如果你在指定时间内没有输入或者输入错误 那么 他会将你 游戏这一块代码给终止掉但是 你之前的Scanner 还在的 因为你并没有输入 线程此时已被释放了 你的Scanner 还没有输入结束 你随意输入下就行了</p><p>当然 还可以使用 System.exit(0) 来强制终止程序 玩玩就行了.</p><p><img src="http://img.huitoushian.cn/%E5%8D%9A%E5%AE%A2/%E8%BD%AE%E6%92%AD%E5%9B%BE%E5%92%8C%E6%96%87%E7%AB%A0%E9%9A%8F%E6%9C%BA%E5%9B%BE/loading.gif" data-original="http://img.huitoushian.cn/%E5%8D%9A%E5%AE%A2/%E6%96%87%E7%AB%A0/java%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E8%BE%93%E5%85%A5%E9%94%99%E8%AF%AF.gif" alt=""></p><p><img src="http://img.huitoushian.cn/%E5%8D%9A%E5%AE%A2/%E8%BD%AE%E6%92%AD%E5%9B%BE%E5%92%8C%E6%96%87%E7%AB%A0%E9%9A%8F%E6%9C%BA%E5%9B%BE/loading.gif" data-original="http://img.huitoushian.cn/%E5%8D%9A%E5%AE%A2/%E6%96%87%E7%AB%A0/java%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E8%B6%85%E6%97%B6.gif" alt=""></p><h2 id="线程池"><a href="#线程池" class="headerlink" title="线程池"></a>线程池</h2><p><img src="http://img.huitoushian.cn/%E5%8D%9A%E5%AE%A2/%E8%BD%AE%E6%92%AD%E5%9B%BE%E5%92%8C%E6%96%87%E7%AB%A0%E9%9A%8F%E6%9C%BA%E5%9B%BE/loading.gif" data-original="http://img.huitoushian.cn/%E5%8D%9A%E5%AE%A2/%E6%96%87%E7%AB%A0/java%E5%A4%9A%E7%BA%BF%E7%A8%8B/d3.jpg" alt=""></p><p><img src="http://img.huitoushian.cn/%E5%8D%9A%E5%AE%A2/%E8%BD%AE%E6%92%AD%E5%9B%BE%E5%92%8C%E6%96%87%E7%AB%A0%E9%9A%8F%E6%9C%BA%E5%9B%BE/loading.gif" data-original="http://img.huitoushian.cn/%E5%8D%9A%E5%AE%A2/%E6%96%87%E7%AB%A0/java%E5%A4%9A%E7%BA%BF%E7%A8%8B/d4.jpg" alt=""></p><p><img src="http://img.huitoushian.cn/%E5%8D%9A%E5%AE%A2/%E8%BD%AE%E6%92%AD%E5%9B%BE%E5%92%8C%E6%96%87%E7%AB%A0%E9%9A%8F%E6%9C%BA%E5%9B%BE/loading.gif" data-original="http://img.huitoushian.cn/%E5%8D%9A%E5%AE%A2/%E6%96%87%E7%AB%A0/java%E5%A4%9A%E7%BA%BF%E7%A8%8B/d5.jpg" alt=""></p><p><img src="http://img.huitoushian.cn/%E5%8D%9A%E5%AE%A2/%E8%BD%AE%E6%92%AD%E5%9B%BE%E5%92%8C%E6%96%87%E7%AB%A0%E9%9A%8F%E6%9C%BA%E5%9B%BE/loading.gif" data-original="http://img.huitoushian.cn/%E5%8D%9A%E5%AE%A2/%E6%96%87%E7%AB%A0/java%E5%A4%9A%E7%BA%BF%E7%A8%8B/d6.jpg" alt=""></p><center><span style="color:red" align="center">(#^.^#)对你有帮助 点击下面的赏 看你心情</span></center><script>document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });</script></div><hr><div class="reprint" id="reprint-statement"><div class="reprint__author"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-user">文章作者: </i></span><span class="reprint-info"><a href="/about" rel="external nofollow noreferrer">胡安民</a></span></div><div class="reprint__type"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-link">文章链接: </i></span><span class="reprint-info"><a href="http://boke.huitoushian.cn/posts/39355.html">http://boke.huitoushian.cn/posts/39355.html</a></span></div><div class="reprint__notice"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-copyright">版权声明: </i></span><span class="reprint-info">本博客所有文章除特別声明外，均采用 <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a> 许可协议。转载请注明来源 <a href="/about" target="_blank">胡安民</a> !</span></div></div><script async defer>document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }</script><div class="tag_share" style="display:block"><div class="post-meta__tag-list" style="display:inline-block"><div class="article-tag"><a href="/tags/java/"><span class="chip bg-color">java</span></a></div></div><div class="post_share" style="zoom:80%;width:fit-content;display:inline-block;float:right;margin:-.15rem 0"><link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css"><div id="article-share"><div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div><script src="/libs/share/js/social-share.min.js"></script></div></div></div><style>#reward{margin:40px 0;text-align:center}#reward .reward-link{font-size:1.4rem;line-height:38px}#reward .btn-floating:hover{box-shadow:0 6px 12px rgba(0,0,0,.2),0 5px 15px rgba(0,0,0,.2)}#rewardModal{width:320px;height:350px}#rewardModal .reward-title{margin:15px auto;padding-bottom:5px}#rewardModal .modal-content{padding:10px}#rewardModal .close{position:absolute;right:15px;top:15px;color:rgba(0,0,0,.5);font-size:1.3rem;line-height:20px;cursor:pointer}#rewardModal .close:hover{color:#ef5350;transform:scale(1.3);-moz-transform:scale(1.3);-webkit-transform:scale(1.3);-o-transform:scale(1.3)}#rewardModal .reward-tabs{margin:0 auto;width:210px}.reward-tabs .tabs{height:38px;margin:10px auto;padding-left:0}.reward-content ul{padding-left:0!important}.reward-tabs .tabs .tab{height:38px;line-height:38px}.reward-tabs .tab a{color:#fff;background-color:#ccc}.reward-tabs .tab a:hover{background-color:#ccc;color:#fff}.reward-tabs .wechat-tab .active{color:#fff!important;background-color:#22ab38!important}.reward-tabs .alipay-tab .active{color:#fff!important;background-color:#019fe8!important}.reward-tabs .reward-img{width:210px;height:210px}</style><div id="reward"><a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a><div id="rewardModal" class="modal"><div class="modal-content"><a class="close modal-close"><i class="fas fa-times"></i></a><h4 class="reward-title">你的赏识是我前进的动力</h4><div class="reward-content"><div class="reward-tabs"><ul class="tabs row"><li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li><li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li></ul><div id="alipay"><img src="http://img.huitoushian.cn/%E5%8D%9A%E5%AE%A2/%E8%BD%AE%E6%92%AD%E5%9B%BE%E5%92%8C%E6%96%87%E7%AB%A0%E9%9A%8F%E6%9C%BA%E5%9B%BE/loading.gif" data-original="http://img.huitoushian.cn/%E5%8D%9A%E5%AE%A2/%E6%88%91%E7%9A%84%E4%BA%8C%E7%BB%B4%E7%A0%81/zhifubao.png" class="reward-img" alt="支付宝打赏二维码"></div><div id="wechat"><img src="http://img.huitoushian.cn/%E5%8D%9A%E5%AE%A2/%E8%BD%AE%E6%92%AD%E5%9B%BE%E5%92%8C%E6%96%87%E7%AB%A0%E9%9A%8F%E6%9C%BA%E5%9B%BE/loading.gif" data-original="http://img.huitoushian.cn/%E5%8D%9A%E5%AE%A2/%E6%88%91%E7%9A%84%E4%BA%8C%E7%BB%B4%E7%A0%81/weixin.png" class="reward-img" alt="微信打赏二维码"></div></div></div></div></div></div><script>$(function(){$(".tabs").tabs()})</script></div></div><style>.valine-card{margin:1.5rem auto}.valine-card .card-content{padding:20px 20px 5px 20px}#vcomments textarea{box-sizing:border-box;background:url(/medias/comment_bg.png) 100% 100% no-repeat}#vcomments p{margin:2px 2px 10px;font-size:1.05rem;line-height:1.78rem}#vcomments blockquote p{text-indent:.2rem}#vcomments a{padding:0 2px;color:#4cbf30;font-weight:500;text-decoration:none}#vcomments img{max-width:100%;height:auto;cursor:pointer}#vcomments ol li{list-style-type:decimal}#vcomments ol,ul{display:block;padding-left:2em;word-spacing:.05rem}#vcomments ul li,ol li{display:list-item;line-height:1.8rem;font-size:1rem}#vcomments ul li{list-style-type:disc}#vcomments ul ul li{list-style-type:circle}#vcomments table,td,th{padding:12px 13px;border:1px solid #dfe2e5}#vcomments table,td,th{border:0}table tr:nth-child(2n),thead{background-color:#fafafa}#vcomments table th{background-color:#f2f2f2;min-width:80px}#vcomments table td{min-width:80px}#vcomments h1{font-size:1.85rem;font-weight:700;line-height:2.2rem}#vcomments h2{font-size:1.65rem;font-weight:700;line-height:1.9rem}#vcomments h3{font-size:1.45rem;font-weight:700;line-height:1.7rem}#vcomments h4{font-size:1.25rem;font-weight:700;line-height:1.5rem}#vcomments h5{font-size:1.1rem;font-weight:700;line-height:1.4rem}#vcomments h6{font-size:1rem;line-height:1.3rem}#vcomments p{font-size:1rem;line-height:1.5rem}#vcomments hr{margin:12px 0;border:0;border-top:1px solid #ccc}#vcomments blockquote{margin:15px 0;border-left:5px solid #42b983;padding:1rem .8rem .3rem .8rem;color:#666;background-color:rgba(66,185,131,.1)}#vcomments pre{font-family:monospace,monospace;padding:1.2em;margin:.5em 0;background:#272822;overflow:auto;border-radius:.3em;tab-size:4}#vcomments code{font-family:monospace,monospace;padding:1px 3px;font-size:.92rem;color:#e96900;background-color:#f8f8f8;border-radius:2px}#vcomments pre code{font-family:monospace,monospace;padding:0;color:#e8eaf6;background-color:#272822}#vcomments pre[class*=language-]{padding:1.2em;margin:.5em 0}#vcomments code[class*=language-],pre[class*=language-]{color:#e8eaf6}#vcomments [type=checkbox]:not(:checked),[type=checkbox]:checked{position:inherit;margin-left:-1.3rem;margin-right:.4rem;margin-top:-1px;vertical-align:middle;left:unset;visibility:visible}#vcomments b,strong{font-weight:700}#vcomments dfn{font-style:italic}#vcomments small{font-size:85%}#vcomments cite{font-style:normal}#vcomments mark{background-color:#fcf8e3;padding:.2em}#vcomments table,td,th{padding:12px 13px;border:1px solid #dfe2e5}table tr:nth-child(2n),thead{background-color:#fafafa}#vcomments table th{background-color:#f2f2f2;min-width:80px}#vcomments table td{min-width:80px}#vcomments [type=checkbox]:not(:checked),[type=checkbox]:checked{position:inherit;margin-left:-1.3rem;margin-right:.4rem;margin-top:-1px;vertical-align:middle;left:unset;visibility:visible}</style><div class="card valine-card" data-aos="fade-up"><div class="comment_headling" style="font-size:20px;font-weight:700;position:relative;padding-left:20px;top:15px;padding-bottom:5px"><i class="fas fa-comments fa-fw" aria-hidden="true"></i> <span>评论</span></div><div id="vcomments" class="card-content" style="display:grid"></div></div><script src="/libs/valine/av-min.js"></script><script src="/libs/valine/Valine.min.js"></script><script>new Valine({el:"#vcomments",appId:"H1na1TiHc0PCHxUcPg64wiBB-gzGzoHsz",appKey:"fKG7vFI4NaMF92qsG4bxjG8q",notify:!1,verify:!1,visitor:!0,avatar:"mm",pageSize:"10",lang:"zh-cn",placeholder:"just go go"})</script><article id="prenext-posts" class="prev-next articles"><div class="row article-row"><div class="article col s12 m6" data-aos="fade-up"><div class="article-badge left-badge text-color"><i class="fas fa-chevron-left"></i>&nbsp;上一篇</div><div class="card"><a href="/posts/41736.html"><div class="card-image"><img src="http://img.huitoushian.cn/%E5%8D%9A%E5%AE%A2/%E8%BD%AE%E6%92%AD%E5%9B%BE%E5%92%8C%E6%96%87%E7%AB%A0%E9%9A%8F%E6%9C%BA%E5%9B%BE/loading.gif" data-original="http://img.huitoushian.cn/%E5%8D%9A%E5%AE%A2/%E8%BD%AE%E6%92%AD%E5%9B%BE%E5%92%8C%E6%96%87%E7%AB%A0%E9%9A%8F%E6%9C%BA%E5%9B%BE/featureimages/480.jpg" class="responsive-img" alt="java-Mybatis使用流程"> <span class="card-title">java-Mybatis使用流程</span></div></a><div class="card-content article-content"><div class="summary block-with-text">java-Mybatis使用流程 官方教学 Mybatis使用流程1.导入jar 或者mvan 的坐标&lt;dependency> &lt;groupId>junit&lt;/groupId> &lt;artifactId>ju</div><div class="publish-info"><span class="publish-date"><i class="far fa-clock fa-fw icon-date"></i>2020-06-19 </span><span class="publish-author"><i class="fas fa-bookmark fa-fw icon-category"></i> <a href="/categories/java-Spring%E5%AE%B6%E6%97%8F/" class="post-category">java-Spring家族</a></span></div></div><div class="card-action article-tags"><a href="/tags/java/"><span class="chip bg-color">java</span> </a><a href="/tags/Mybatis/"><span class="chip bg-color">Mybatis</span></a></div></div></div><div class="article col s12 m6" data-aos="fade-up"><div class="article-badge right-badge text-color">下一篇&nbsp;<i class="fas fa-chevron-right"></i></div><div class="card"><a href="/posts/58668.html"><div class="card-image"><img src="http://img.huitoushian.cn/%E5%8D%9A%E5%AE%A2/%E8%BD%AE%E6%92%AD%E5%9B%BE%E5%92%8C%E6%96%87%E7%AB%A0%E9%9A%8F%E6%9C%BA%E5%9B%BE/loading.gif" data-original="http://img.huitoushian.cn/%E5%8D%9A%E5%AE%A2/%E8%BD%AE%E6%92%AD%E5%9B%BE%E5%92%8C%E6%96%87%E7%AB%A0%E9%9A%8F%E6%9C%BA%E5%9B%BE/featureimages/581.jpg" class="responsive-img" alt="java泛型大全"> <span class="card-title">java泛型大全</span></div></a><div class="card-content article-content"><div class="summary block-with-text">java泛型大全 1. 概述泛型在java中有很重要的地位，在面向对象编程及各种设计模式中有非常广泛的应用。 什么是泛型？为什么要使用泛型？ 泛型，即“参数化类型”。一提到参数，最熟悉的就是定义方法形参，然后调用此方法时 传递的 实参。那</div><div class="publish-info"><span class="publish-date"><i class="far fa-clock fa-fw icon-date"></i>2020-06-14 </span><span class="publish-author"><i class="fas fa-bookmark fa-fw icon-category"></i> <a href="/categories/java/" class="post-category">java</a></span></div></div><div class="card-action article-tags"><a href="/tags/java/"><span class="chip bg-color">java</span></a></div></div></div></div></article></div><script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script><script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script><script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script><script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script><style type="text/css">code[class*=language-],pre[class*=language-]{white-space:pre!important}</style></div><div id="toc-aside" class="expanded col l3 hide-on-med-and-down"><div class="toc-widget"><div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div><div id="toc-content"></div></div></div></div><div id="floating-toc-btn" class="hide-on-med-and-down"><a class="btn-floating btn-large bg-color"><i class="fas fa-list-ul"></i></a></div><script src="/libs/tocbot/tocbot.min.js"></script><script>$(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('h6'),
            headingSelector: 'h2, h3, h4 ,h5 ,h6'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4 ,h5 ,h6').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });</script></main><footer class="page-footer bg-color"><link rel="stylesheet" href="/libs/aplayer/APlayer.min.css"><style>.aplayer .aplayer-lrc p{font-size:12px;font-weight:700;line-height:16px!important}.aplayer .aplayer-lrc p.aplayer-lrc-current{font-size:15px;color:#42b983}.aplayer.aplayer-fixed.aplayer-narrow .aplayer-body{left:-66px!important}.aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover{left:0!important}</style><div><div class="row"><meting-js class="col l8 offset-l2 m10 offset-m1 s12" server="netease" type="playlist" id="2688981661" fixed="true" autoplay theme="#42b983" loop order="random" preload="auto" volume="0.7" list-folded="false"></meting-js></div></div><script src="/libs/aplayer/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script><div class="container row center-align" style="margin-bottom:0!important"><div class="col s12 m8 l8 copy-right">Copyright&nbsp;&copy; <span id="year">2020</span> <a href="/about" target="_blank">胡安民</a><br><span id="busuanzi_container_site_pv">|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;<span id="busuanzi_value_site_pv" class="white-color"></span>&nbsp;次 </span><span id="busuanzi_container_site_uv">|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;<span id="busuanzi_value_site_uv" class="white-color"></span>&nbsp;人</span><br><br></div><div class="col s12 m4 l4 social-link social-statis"><a href="https://github.com/" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50"><i class="fab fa-github"></i> </a><a href="mailto:3426154361@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50"><i class="fas fa-envelope-open"></i> </a><a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=3426154361" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 3426154361" data-position="top" data-delay="50"><i class="fab fa-qq"></i> </a><a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50"><i class="fas fa-rss"></i></a></div></div></footer><div class="progress-bar"></div><div id="searchModal" class="modal"><div class="modal-content"><div class="search-header"><span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span> <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字" class="search-input"></div><div id="searchResult"></div></div></div><script src="/js/search.js"></script><script type="text/javascript">$(function(){searchFunc("/search.xml","searchInput","searchResult")})</script><div id="backTop" class="top-scroll"><a class="btn-floating btn-large waves-effect waves-light" href="#!"><i class="fas fa-arrow-up"></i></a></div><script src="/libs/materialize/materialize.min.js"></script><script src="/libs/masonry/masonry.pkgd.min.js"></script><script src="/libs/aos/aos.js"></script><script src="/libs/scrollprogress/scrollProgress.min.js"></script><script src="/libs/lightGallery/js/lightgallery-all.min.js"></script><script src="/js/matery.js"></script><script src="/js/click_show_text.js"></script><script type="text/javascript">var windowWidth=$(window).width();768<windowWidth&&document.write('<script type="text/javascript" src="/js/sakura.js"><\/script>')</script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script><script src="/libs/others/clicklove.js" async></script><script async src="/libs/others/busuanzi.pure.mini.js"></script><script>!function(e,t,o,c,a,i,n){e.DaoVoiceObject=a,e[a]=e[a]||function(){(e[a].q=e[a].q||[]).push(arguments)},e[a].l=+new Date,i=t.createElement(o),n=t.getElementsByTagName(o)[0],i.async=1,i.src=c,i.charset="utf-8",n.parentNode.insertBefore(i,n)}(window,document,"script",("https:"==document.location.protocol?"https:":"http:")+"//widget.daovoice.io/widget/6984b559.js","daovoice"),daovoice("init",{app_id:"2966aa5c"}),daovoice("update")</script><script type="text/javascript" color="127,69,110" pointcolor="0,0,255" opacity="0.5" zindex="-1" count="200" src="/libs/background/canvas-nest.js"></script><script type="text/javascript" src="/libs/background/ribbon-dynamic.js" async></script><script src="/libs/instantpage/instantpage.js" type="module"></script><script type="text/javascript">var st,OriginTitile=document.title;document.addEventListener("visibilitychange",function(){document.hidden?(document.title="ヽ(●-`Д´-)ノ",clearTimeout(st)):(document.title="(Ő∀Ő3)ノ",st=setTimeout(function(){document.title=OriginTitile},3e3))})</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,debug:!1,model:{jsonPath:"/live2dw/assets/z16.model.json"},display:{position:"left",width:165,height:335,hOffset:-10,vOffset:30},mobile:{show:!0,scale:.5},react:{opacity:.7},log:!1})</script><script>window.imageLazyLoadSetting={isSPA:!1,processImages:null}</script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})})</script><script>!function(n){n.imageLazyLoadSetting.processImages=i;var e=n.imageLazyLoadSetting.isSPA,r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function i(){e&&(r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")));for(var t,a=0;a<r.length;a++)0<=(t=(t=r[a]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(n.innerHeight+240||document.documentElement.clientHeight+240)&&function(){var e=r[a],t=e,n=function(){r=r.filter(function(t){return e!==t})},i=new Image,o=t.getAttribute("data-original");i.onload=function(){t.src=o,n()},i.src=o}()}i(),n.addEventListener("scroll",function(){var t=i,e=n;clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(e)},500)})}(this)</script></body></html>